INSERT INTO BONUS
SELECT E.ENAME, E.JOB,E.SAL,
                    CASE WHEN E.JOB IN ('ANALYST','PRESIDENT') THEN 0
                         WHEN C.CUSCNT >= 100000 THEN NVL(E.COMM,0)+2000
                         ELSE NVL(E.COMM,0)+1000
                    END AS COMM
FROM EMP E
LEFT JOIN (SELECT ACCOUNT_MGR,COUNT(ACCOUNT_MGR) AS CUSCNT
            FROM CUSTOMER
            GROUP BY ACCOUNT_MGR) C
ON E.EMPNO=C.ACCOUNT_MGR;